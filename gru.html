<!doctype html>
<html lang="en" class="">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="Pretained Image Recognition Models">
    <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.9">
    <title>Gated Recurrent Units</title>

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href=""
        href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
    <link rel="stylesheet" href="css/style.css">
    <!-- <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script> -->

</head>

<body>
    <header class="">
        <nav class="navbar navbar-expand-lg navbar-light bg txt-white fixed-top">
            <div class="container-fluid container">
                <div class="">
                    <label><i class="ri-bar-chart-grouped-line"></i></label>
                    <a class="navbar-brand txt-white" href="#">Int Elligence</a>
                </div>

                <div class="d-flex ">
                    <a class="navbar-brand txt-white" href="https://github.com/IntElligence0">Packages</a>
                </div>
            </div>
        </nav>

    </header>

    <section class="sec-margin-top">
        <div>
            <div class="container-fluid">
                <div class="row">

                    <div class="col-lg-3 col-md-3 col-sm-3">
                        <div class="margin-top">
                            <h5>Tensorflow Forcasting Models</h5>
                            <div id="myDIV">
                                <div class=" flex activation margin-top active" style="width: 35%;">
                                    <a class="activation" href="index.html"><i class="ri-home-gear-fill"></i>

                                        <p style="margin-top: -26px; margin-left: 18px;">Getting start</p>
                                    </a>
                                </div>

                                <div class=" flex activation active" style="width: 42%;">
                                    <a class="activation" href="model summary.html"><i class="ri-file-list-3-fill"></i>
                                        <p style="margin-top: -26px; margin-left: 18px;">Model summarize</p>
                                    </a>
                                </div>
                                <div class="dropdown" style="width: 416px;">
                                    <a class="dropdown-toggle" href="#" id="dropdownMenuLink" data-bs-toggle="dropdown"
                                        aria-expanded="false"><i class="ri-article-fill"></i>
                                        Model Pages
                                    </a>

                                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink"
                                        style="overflow: scroll; height: 357px;">
                                        <li><a class="dropdown-item activation hov" href="TCN.html">Temporal
                                                Convolutional
                                                Networks
                                                TCN</a>
                                        </li>
                                        <li><a class="dropdown-item activation hov"
                                                href="transformer.html">Transformer</a></li>
                                        <li><a class="dropdown-item activation hov" href="performer.html">Performer</a>
                                        </li>
                                        <li><a class="dropdown-item activation hov" href="CNN-LSTM.html">CNN Long
                                                Short-Term Memory
                                                Networks (CNN-LSTM)</a></li>
                                        <li><a class="dropdown-item activation hov" href="Time distributed.html">Time
                                                Distributed</a></li>
                                        <li><a class="dropdown-item activation hov" href="Bi-lstm.html">Bi-directional
                                                long short
                                                term memory (Bi-LSTM)</a></li>
                                        <li><a class="dropdown-item activation hov" href="BiGru.html">Bi-directional
                                                Gated
                                                Recurrent Units (Bi-GRU)</a></li>
                                        <li><a class="dropdown-item activation hov" href="gru.html">Gated Recurrent
                                                Units
                                                (GRU)</a></li>
                                        <li><a class="dropdown-item activation hov" href="cnn.html">Convolutional Neural
                                                Network (CNN)</a></li>
                                        <li><a class="dropdown-item activation hov" href="lstm.html">Long Short-Term
                                                Memory
                                                networks (LSTM)</a></li>
                                        <li><a class="dropdown-item activation hov" href="deepar.html">DeepAR</a></li>
                                        <li><a class="dropdown-item activation hov" href="tlnn.html">Time Lagged
                                                Neural
                                                Network (TLNN)</a></li>
                                        <li><a class="dropdown-item activation hov" href="bert.html">Bidirectional
                                                Encoder Representations from Transformers
                                                (Bert)</a></li>
                                        <li><a class="dropdown-item activation hov" href="Seq2seq.html">Seq2Seq
                                            </a></li>
                                        <li><a class="dropdown-item activation hov" href="fnn.html">feedforward neural
                                                network (FNN)
                                            </a></li>
                                        <li><a class="dropdown-item activation hov" href="N-BEATS.html">N-BEATS
                                            </a></li>
                                        <li><a class="dropdown-item activation hov" href="Autoformer.html">Autoformer
                                            </a></li>
                                        <li><a class="dropdown-item activation hov" href="rbfn.html">Radial basis
                                                function network (RBFN)
                                            </a></li>
                                        <li><a class="dropdown-item activation hov" href="mlp.html">mlp
                                            </a></li>
                                        <li><a class="dropdown-item activation hov" href="convlstm.html">convlstm
                                            </a></li>
                                        <li><a class="dropdown-item activation hov" href="informer.html">Informer
                                            </a></li>
                                    </ul>
                                </div>
                                <div>
                                    <div class=" flex activation margin-top active" style="width: 35%;">
                                        <a class="activation" href="result.html"><i class="ri-question-answer-fill"></i>

                                            <p style="margin-top: -26px; margin-left: 18px;">Results</p>
                                        </a>
                                    </div>
                                    <div class=" flex activation  active" style="width: 42%;">
                                        <a class="activation" href="index.html"><i class="ri-file-edit-fill"></i>

                                            <p style="margin-top: -26px; margin-left: 18px;">Recent changes</p>
                                        </a>
                                    </div>

                                </div>
                            </div>


                        </div>

                    </div>
                    <div class="col-lg-9 col-md-12 col-sm-9 body">

                        <main>
                            <h1 class="">Basic GRU Overview</h1>
                            <p>
                                GRUs are very similar to Long Short Term Memory(LSTM). Just like LSTM, GRU uses gates to
                                control the flow of
                                information. They are relatively new as compared to LSTM. This is the reason they offer
                                some improvement over LSTM and
                                have simpler architecture.
                            </p>
                            <div class=" bg-size">
                                <img src="img/Screenshot-from-2021-03-17-16-32-42.webp">
                            </div>
                            <p>Another Interesting thing about GRU is that, unlike LSTM, it does not have a separate
                                cell state (Ct). It only has a
                                hidden state(Ht). Due to the simpler architecture, GRUs are faster to train.
                            </p>
                            <h2>The architecture of Gated Recurrent Unit</h2>
                            <p>Now lets’ understand how GRU works. Here we have a GRU cell which more or less similar to
                                an LSTM cell or RNN cell.</p>
                            <div class=" bg-size">
                                <img src="img/Screenshot-from-2021-03-17-14-24-12.webp">
                            </div>
                            <p>At each timestamp t, it takes an input Xt and the hidden state Ht-1 from the previous
                                timestamp t-1. Later it outputs a
                                new hidden state Ht which again passed to the next timestamp.
                            </p>

                            <p>Now there are primarily two gates in a GRU as opposed to three gates in an LSTM cell. The
                                first gate is the Reset gate
                                and the other one is the update gate.</p>


                            <h3>Reset Gate (Short term memory)</h3>
                            <p>The Reset Gate is responsible for the short-term memory of the network i.e the hidden
                                state (Ht). Here is the equation
                                of the Reset gate.</p>
                            <div class=" bg-size">
                                <img src="img/Screenshot-from-2021-03-17-14-34-17.webp">
                            </div>
                            <p>If you remember from the LSTM gate equation it is very similar to that. The value of rt
                                will range from 0 to 1 because
                                of the sigmoid function. Here Ur and Wr are weight matrices for the reset gate.
                            </p>



                            <h3> Gate (Long Term memory)</h3>
                            <p>Similarly, we have an Update gate for long-term memory and the equation of the gate is
                                shown below.</p>
                            <div class=" bg-size">
                                <img src="img/Screenshot-from-2021-03-17-15-13-00.png">
                            </div>
                            <p>The only difference is of weight metrics i.e Uu and Wu.
                            </p>

                            <h2>The architecture of Gated Recurrent Unit</h2>
                            <p>Now lets’ understand how GRU works. Here we have a GRU cell which more or less similar to
                                an LSTM cell or RNN cell.</p>
                            <div class=" bg-size">
                                <img src="img/Screenshot-from-2021-03-17-14-24-12.webp">
                            </div>
                            <p>At each timestamp t, it takes an input Xt and the hidden state Ht-1 from the previous
                                timestamp t-1. Later it outputs a
                                new hidden state Ht which again passed to the next timestamp.
                            </p>

                            <p>Now there are primarily two gates in a GRU as opposed to three gates in an LSTM cell. The
                                first gate is the Reset gate
                                and the other one is the update gate.</p>


                            <h3>Reset Gate (Short term memory)</h3>
                            <p>The Reset Gate is responsible for the short-term memory of the network i.e the hidden
                                state (Ht). Here is the equation
                                of the Reset gate.</p>
                            <div class=" bg-size">
                                <img src="img/Screenshot-from-2021-03-17-14-34-17.webp">
                            </div>
                            <p>If you remember from the LSTM gate equation it is very similar to that. The value of rt
                                will range from 0 to 1 because
                                of the sigmoid function. Here Ur and Wr are weight matrices for the reset gate.
                            </p>


                            <h2>How GRU Works</h2>
                            <p>Now let’s see the functioning of these gates. To find the Hidden state Ht in GRU, it
                                follows a two-step process. The
                                first step is to generate what is known as the candidate hidden state. As shown below
                            </p>
                            <h3>Candidate Hidden State</h3>
                            <div class=" bg-size">
                                <img src="img/Screenshot-from-2021-03-17-15-18-46.png">
                            </div>
                            <p>It takes in the input and the hidden state from the previous timestamp t-1 which is
                                multiplied by the reset gate output
                                rt. Later passed this entire information to the tanh function, the resultant value is
                                the candidate’s hidden state.
                            </p>
                            <div class=" bg-size">
                                <img src="img/Screenshot-from-2021-03-17-15-25-50.png">
                            </div>

                            <p>The most important part of this equation is how we are using the value of the reset gate
                                to control how much influence
                                the previous hidden state can have on the candidate state.</p>


                            <p>If the value of rt is equal to 1 then it means the entire information from the previous
                                hidden state Ht-1 is being
                                considered. Likewise, if the value of rt is 0 then that means the information from the
                                previous hidden state is
                                completely ignored.</p>

                            <h3>Reset Gate (Short term memory)</h3>
                            <p>The Reset Gate is responsible for the short-term memory of the network i.e the hidden
                                state (Ht). Here is the equation
                                of the Reset gate.</p>
                            <div class=" bg-size">
                                <img src="img/Screenshot-from-2021-03-17-14-34-17.webp">
                            </div>
                            <p>If you remember from the LSTM gate equation it is very similar to that. The value of rt
                                will range from 0 to 1 because
                                of the sigmoid function. Here Ur and Wr are weight matrices for the reset gate.
                            </p>
                            <h3>Hidden state</h3>
                            <p>Once we have the candidate state, it is used to generate the current hidden state Ht. It
                                is where the Update gate comes
                                into the picture. Now, this is a very interesting equation, instead of using a separate
                                gate like in LSTM in GRU we use
                                a single update gate to control both the historical information which is Ht-1 as well as
                                the new information which comes
                                from the candidate state.</p>
                            <div class=" bg-size">
                                <img src="img/Screenshot-from-2021-03-17-16-18-11.webp">
                            </div>
                            <p>Now assume the value of ut is around 0 then the first term in the equation will vanish
                                which means the new hidden state
                                will not have much information from the previous hidden state. On the other hand, the
                                second part becomes almost one
                                that essentially means the hidden state at the current timestamp will consist of the
                                information from the candidate
                                state only.</p>
                            <div class=" bg-size">
                                <img src="img/Screenshot-from-2021-03-17-16-17-14.webp">
                            </div>
                            <p>Similarly, if the value of ut is on the second term will become entirely 0 and the
                                current hidden state will entirely
                                depend on the first term i.e the information from the hidden state at the previous
                                timestamp t-1.</p>
                            <div class=" bg-size">
                                <img src="img/Screenshot-from-2021-03-17-16-17-21.webp">
                            </div>
                            <p>Hence we can conclude that the value of ut is very critical in this equation and it can
                                range from 0 to 1.</p>
                            <div>
                                <h2>build GRU model</h2>
                                <p>now we will know how to use GRU </p>
                                <h3>import package</h3>
                                <div class="" id="Install">
                                    <code class="flex" style="width:100%;">
                                        <p class="line "  id="myText" style="padding-left: 5px;">from <span class="import-color">Energy_Models</span> import 
                                        <span class="import-color">GRU</span> as <span class="import-color">m</span>
                                        </p>
                                        <!-- <button class="icon" onclick="copyContent()"><i class="ri-file-copy-line"></i></button> -->
                                    </code>
                                </div>
                                <div>
                                    <h3>call the model</h3>
                                    <div class="" id="Install">
                                        <code class="flex" style="width:100%;">
                                            <p class="line "  id="myText" style="padding-left: 5px;">model = m.<span class="import-color">GRU_model(<span class="package-color">n_steps,n_features,n_outputs</span>)</span>.getModel()
                                            </p>
                                            <!-- <button class="icon" onclick="copyContent()"><i class="ri-file-copy-line"></i></button> -->
                                        </code>
                                    </div>
                                    <h4>model's parameter</h4>
                                    <p><span class="package-color">n_steps</span> : number of days you want to
                                        predict
                                        on
                                    </p>
                                    <p><span class="package-color">n_features</span> : number of columns in data
                                        that
                                        will
                                        give to model</p>
                                    <p><span class="package-color">n_outputs</span> : number of coulmns that model
                                        will
                                        predict and by default its equal 1</p>
                                </div>
                                <div>
                                    <h3>compile the model</h3>
                                    <div class="" id="Install">
                                        <code class="flex" style="width:100%;">
                                            <p class="line "  id="myText" style="padding-left: 5px;">model.compile(<span class="import-color">optimizer='adam', loss ='mse'</span>)
                                            </p>
                                            <!-- <button class="icon" onclick="copyContent()"><i class="ri-file-copy-line"></i></button> -->
                                        </code>
                                    </div>
                                    <h4>compile parameter </h4>
                                    <p><span class="package-color">optimizer : </span> While training the deep
                                        learning
                                        model, we need to modify each epoch’s weights and minimize the loss
                                        function. An
                                        optimizer is a function or an algorithm that modifies the attributes of the
                                        neural network, such as weights and learning
                                        rate. Thus, it helps in reducing the overall loss and improve the accuracy.
                                        <span class="mid_grey">here we use adam</span>
                                    </p>
                                    <p><span class="package-color">loss : </span>the Loss function is a method of
                                        evaluating how well your algorithm is modeling your dataset</p>
                                </div>
                                <div>
                                    <h3>fit the model</h3>
                                    <div class="" id="Install">
                                        <code class="flex" style="width:100%;">
                                            <p class="line "  id="myText" style="padding-left: 5px;">history = model.fit(<span class="import-color">X_train, y_train, batch_size=256, validation_split=0.3,epochs=85, verbose=1,
                                            shuffle=False)</span>
                                            </p>
                                            <!-- <button class="icon" onclick="copyContent()"><i class="ri-file-copy-line"></i></button> -->
                                        </code>
                                    </div>
                                    <h4>fit's parameter</h4>
                                    <p>frist you pass your data then </p>
                                    <p><span class="package-color">batch_size : </span>refers to the number of
                                        training
                                        examples utilized in one iteration</p>
                                    <p><span class="package-color">validation_split : </span>Float between 0 and 1.
                                        Fraction of the training data to be used as validation data; selected from
                                        the
                                        last samples in the x and y data provided, before shuffling.</p>
                                    <p><span class="package-color">epochs : </span>The number of epochs is a
                                        hyperparameter
                                        that defines the number times that the learning algorithm will work through
                                        the
                                        entire training dataset.</p>
                                    <p><span class="package-color">verbose : </span>By setting verbose 0, 1 or 2 you
                                        just
                                        say how do you want to 'see' the training progress for each epoch.</p>

                                </div>

                                <div>


                                    <h3>predict the moodel for testing</h3>
                                    <div class="" id="Install">
                                        <code class="flex" style="width:100%;">
                                            <p class="line "  id="myText" style="padding-left: 5px;"><span class="import-color">y_pred_test</span>
                                                =m.predict((<span class="import-color">X_test</span>
                                            )</p>
                                            <!-- <button class="icon" onclick="copyContent()"><i class="ri-file-copy-line"></i></button> -->
                                        </code>
                                    </div>
                                </div>
                                <div>


                                    <h3>predict the moodel for training</h3>
                                    <div class="" id="Install">
                                        <code class="flex" style="width:100%;">
                                            <p class="line "  id="myText" style="padding-left: 5px;"><span class="import-color">y_pred_test</span>
                                                =m.predict((<span class="import-color">X_train</span>
                                            )</p>
                                            <!-- <button class="icon" onclick="copyContent()"><i class="ri-file-copy-line"></i></button> -->
                                        </code>
                                    </div>
                                </div>
                                <div>
                                    <h3>Evaluation_Metrix</h3>
                                    <h3>import package</h3>
                                    <div class="" id="Install">
                                        <code class="flex" style="width:100%;">
                                        <p class="line "  id="myText" style="padding-left: 5px;">from <span class="import-color">Energy_Models</span> import 
                                        <span class="import-color">Evaluation_Metrix</span> as <span>mx</span>
                                        </p>
                                        <!-- <button class="icon" onclick="copyContent()"><i class="ri-file-copy-line"></i></button> -->
                                    </code>
                                    </div>
                                    <div class="" id="Install">
                                        <code class="flex" style="width:100%;">
                                            <p class="line "  id="myText" style="padding-left: 5px;">mx.print_metrics(<span class="import-color">y_train,y_pred_train,y_test
                                                ,y_pred_test</span>
                                                =m.predict((<span class="import-color">X_train</span>
                                            )</p>
                                            <!-- <button class="icon" onclick="copyContent()"><i class="ri-file-copy-line"></i></button> -->
                                        </code>
                                    </div>
                                </div>
                                <h3>build it from scratch</h3>
                                <div class="" id="Install">
                                    <code class="flex" style="width:100%;">
                                            <p class="line "  id="myText" style="padding-left: 5px;"> <a href="https://github.com/IntElligence0/Energy_apps_Tk/blob/main/models_from_scratch/GRU.py" class=""><span class="import-color padding">THE SOURCE CODE <i style="float:right;" class="padding ri-code-box-fill"></i></span></a>
                                            </p>
                                            <!-- <button class="icon" onclick="copyContent()"><i class="ri-file-copy-line"></i></button> -->
                                        </code>
                                </div>
                            </div>
                        </main>
                        <nav id="toc" class="Fixed">
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <footer class="bg text-center text-lg-start txt-white">
        <!-- Copyright -->
        <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
            © 2020 Copyright:
            <a class="txt-white" href="">created by Int Elligence Team</a>
        </div>
        <!-- Copyright -->
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="js/script.js"></script>


</body>